<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QC Alert Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Sarabun', sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <h1 class="text-3xl font-bold text-gray-800 mb-2">‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô QC</h1>
            <p class="text-gray-600">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡πÉ‡∏ô‡πÅ‡∏ú‡∏ô‡∏Å QC</p>
        </div>

        <!-- Add New Alert Form -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÉ‡∏´‡∏°‡πà</h2>
            <form id="alertForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</label>
                    <input type="text" id="title" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</label>
                    <select id="category" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                        <option value="quality-issue">‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û</option>
                        <option value="process-change">‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£</option>
                        <option value="equipment">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</option>
                        <option value="safety">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</option>
                        <option value="training">‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°</option>
                        <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</label>
                    <select id="priority" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö</option>
                        <option value="high">‡∏™‡∏π‡∏á</option>
                        <option value="medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                        <option value="low">‡∏ï‡πà‡∏≥</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label>
                    <input type="text" id="assignee" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                </div>
                <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</label>
                    <textarea id="description" rows="3" required class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"></textarea>
                </div>
                <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡πÅ‡∏ô‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                    <input type="file" id="imageUpload" accept="image/*" multiple class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <p class="text-sm text-gray-500 mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå JPG, PNG, GIF (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå)</p>
                    <div id="imagePreview" class="mt-3 grid grid-cols-2 md:grid-cols-4 gap-3"></div>
                </div>
                <div class="md:col-span-2">
                    <label class="block text-sm font-medium text-gray-700 mb-2">‡πÅ‡∏ô‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
                    <input type="file" id="fileUpload" multiple class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <p class="text-sm text-gray-500 mt-1">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡πÑ‡∏ü‡∏•‡πå PDF, DOC, DOCX, XLS, XLSX, TXT ‡πÅ‡∏•‡∏∞‡∏≠‡∏∑‡πà‡∏ô‡πÜ (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡πÑ‡∏ü‡∏•‡πå)</p>
                    <div id="filePreview" class="mt-3 space-y-2"></div>
                </div>
                <div class="md:col-span-2">
                    <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                        ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô
                    </button>
                </div>
            </form>
        </div>

        <!-- Search and Filter -->
        <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏á</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <input type="text" id="searchInput" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤..." class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                <select id="filterCategory" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                    <option value="quality-issue">‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û</option>
                    <option value="process-change">‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£</option>
                    <option value="equipment">‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå</option>
                    <option value="safety">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</option>
                    <option value="training">‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°</option>
                    <option value="other">‡∏≠‡∏∑‡πà‡∏ô‡πÜ</option>
                </select>
                <select id="filterPriority" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏£‡∏∞‡∏î‡∏±‡∏ö</option>
                    <option value="high">‡∏™‡∏π‡∏á</option>
                    <option value="medium">‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á</option>
                    <option value="low">‡∏ï‡πà‡∏≥</option>
                </select>
                <select id="filterStatus" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">‡∏ó‡∏∏‡∏Å‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</option>
                    <option value="open">‡πÄ‡∏õ‡∏¥‡∏î</option>
                    <option value="in-progress">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option>
                    <option value="resolved">‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß</option>
                </select>
            </div>
        </div>

        <!-- Alerts List -->
        <div class="bg-white rounded-xl shadow-lg p-6">
            <h2 class="text-xl font-semibold text-gray-800 mb-4">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h2>
            <div id="alertsList" class="space-y-4">
                <!-- Sample data will be populated here -->
            </div>
        </div>
    </div>

    <!-- Alert Detail Modal -->
    <div id="alertModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
        <div class="bg-white rounded-xl p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-semibold text-gray-800">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <div id="modalContent">
                <!-- Modal content will be populated here -->
            </div>
        </div>
    </div>

    <!-- Image Viewer Modal -->
    <div id="imageModal" class="fixed inset-0 bg-black bg-opacity-90 hidden items-center justify-center z-60">
        <div class="relative max-w-4xl max-h-[90vh] mx-4">
            <button id="closeImageModal" class="absolute -top-10 right-0 text-white hover:text-gray-300 text-2xl">
                <svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                </svg>
            </button>
            <img id="fullImage" src="" alt="" class="max-w-full max-h-[90vh] object-contain rounded-lg">
            <div id="imageInfo" class="text-white text-center mt-4 text-sm"></div>
        </div>
    </div>

    <script>
        // Sample data for demonstration
        let alerts = [
            {
                id: 1,
                title: "‡∏ï‡∏£‡∏ß‡∏à‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡∏°‡∏≤‡∏ï‡∏£‡∏ê‡∏≤‡∏ô Lot ABC123",
                category: "quality-issue",
                priority: "high",
                status: "open",
                assignee: "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ä‡∏≤‡∏¢",
                description: "‡∏û‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏ô‡∏•‡πá‡∏≠‡∏ï ABC123 ‡∏°‡∏µ‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÑ‡∏°‡πà‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î ‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏¢‡∏∏‡∏î‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£",
                images: [],
                files: [],
                createdAt: new Date('2024-01-15T10:30:00'),
                updatedAt: new Date('2024-01-15T10:30:00')
            },
            {
                id: 2,
                title: "‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û",
                category: "process-change",
                priority: "medium",
                status: "in-progress",
                assignee: "‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏´‡∏ç‡∏¥‡∏á",
                description: "‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ç‡∏±‡πâ‡∏ô‡∏ï‡∏≠‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏°‡πà ‡∏ï‡πâ‡∏≠‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÉ‡∏´‡πâ‡∏ó‡∏µ‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏£‡∏≤‡∏ö‡πÅ‡∏•‡∏∞‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°",
                images: [],
                files: [],
                createdAt: new Date('2024-01-14T14:20:00'),
                updatedAt: new Date('2024-01-15T09:15:00')
            }
        ];

        const categoryLabels = {
            'quality-issue': '‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û',
            'process-change': '‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á‡∏Å‡∏£‡∏∞‡∏ö‡∏ß‡∏ô‡∏Å‡∏≤‡∏£',
            'equipment': '‡∏≠‡∏∏‡∏õ‡∏Å‡∏£‡∏ì‡πå',
            'safety': '‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢',
            'training': '‡∏Å‡∏≤‡∏£‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°',
            'other': '‡∏≠‡∏∑‡πà‡∏ô‡πÜ'
        };

        const priorityLabels = {
            'high': '‡∏™‡∏π‡∏á',
            'medium': '‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á',
            'low': '‡∏ï‡πà‡∏≥'
        };

        const statusLabels = {
            'open': '‡πÄ‡∏õ‡∏¥‡∏î',
            'in-progress': '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
            'resolved': '‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß'
        };

        const priorityColors = {
            'high': 'bg-red-100 text-red-800',
            'medium': 'bg-yellow-100 text-yellow-800',
            'low': 'bg-green-100 text-green-800'
        };

        const statusColors = {
            'open': 'bg-blue-100 text-blue-800',
            'in-progress': 'bg-orange-100 text-orange-800',
            'resolved': 'bg-green-100 text-green-800'
        };

        // Image preview functionality
        document.getElementById('imageUpload').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            const preview = document.getElementById('imagePreview');
            preview.innerHTML = '';

            files.forEach((file, index) => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const imageContainer = document.createElement('div');
                        imageContainer.className = 'relative group';
                        imageContainer.innerHTML = `
                            <img src="${e.target.result}" alt="Preview ${index + 1}" class="w-full h-24 object-cover rounded-lg border">
                            <button type="button" onclick="removeImage(${index})" class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 text-xs hover:bg-red-600 opacity-0 group-hover:opacity-100 transition-opacity">√ó</button>
                            <div class="text-xs text-gray-500 mt-1 truncate">${file.name}</div>
                        `;
                        preview.appendChild(imageContainer);
                    };
                    reader.readAsDataURL(file);
                }
            });
        });

        // File preview functionality
        document.getElementById('fileUpload').addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            const preview = document.getElementById('filePreview');
            preview.innerHTML = '';

            files.forEach((file, index) => {
                const fileContainer = document.createElement('div');
                fileContainer.className = 'flex items-center justify-between p-3 bg-gray-50 rounded-lg border';
                
                const fileIcon = getFileIcon(file.type, file.name);
                const fileSize = (file.size / 1024).toFixed(1);
                
                fileContainer.innerHTML = `
                    <div class="flex items-center space-x-3">
                        <div class="text-2xl">${fileIcon}</div>
                        <div>
                            <div class="text-sm font-medium text-gray-800 truncate max-w-xs">${file.name}</div>
                            <div class="text-xs text-gray-500">${fileSize} KB</div>
                        </div>
                    </div>
                    <button type="button" onclick="removeFile(${index})" class="text-red-500 hover:text-red-700 text-sm">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                        </svg>
                    </button>
                `;
                preview.appendChild(fileContainer);
            });
        });

        // Get file icon based on file type
        function getFileIcon(fileType, fileName) {
            const extension = fileName.split('.').pop().toLowerCase();
            
            if (fileType.includes('pdf') || extension === 'pdf') return 'üìÑ';
            if (fileType.includes('word') || ['doc', 'docx'].includes(extension)) return 'üìù';
            if (fileType.includes('excel') || fileType.includes('spreadsheet') || ['xls', 'xlsx'].includes(extension)) return 'üìä';
            if (fileType.includes('powerpoint') || ['ppt', 'pptx'].includes(extension)) return 'üìã';
            if (fileType.includes('text') || extension === 'txt') return 'üìÉ';
            if (fileType.includes('zip') || fileType.includes('rar') || ['zip', 'rar', '7z'].includes(extension)) return 'üóúÔ∏è';
            if (fileType.includes('video') || ['mp4', 'avi', 'mov'].includes(extension)) return 'üé•';
            if (fileType.includes('audio') || ['mp3', 'wav', 'ogg'].includes(extension)) return 'üéµ';
            
            return 'üìé';
        }

        // Remove image from preview
        function removeImage(index) {
            const fileInput = document.getElementById('imageUpload');
            const dt = new DataTransfer();
            const files = Array.from(fileInput.files);
            
            files.forEach((file, i) => {
                if (i !== index) {
                    dt.items.add(file);
                }
            });
            
            fileInput.files = dt.files;
            fileInput.dispatchEvent(new Event('change'));
        }

        // Remove file from preview
        function removeFile(index) {
            const fileInput = document.getElementById('fileUpload');
            const dt = new DataTransfer();
            const files = Array.from(fileInput.files);
            
            files.forEach((file, i) => {
                if (i !== index) {
                    dt.items.add(file);
                }
            });
            
            fileInput.files = dt.files;
            fileInput.dispatchEvent(new Event('change'));
        }

        // Form submission
        document.getElementById('alertForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const imageFiles = Array.from(document.getElementById('imageUpload').files);
            const documentFiles = Array.from(document.getElementById('fileUpload').files);
            const images = [];
            const files = [];
            
            // Convert images to base64 for storage
            const processImages = imageFiles.map(file => {
                return new Promise((resolve) => {
                    if (file.type.startsWith('image/')) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            images.push({
                                name: file.name,
                                data: e.target.result,
                                size: file.size,
                                type: file.type
                            });
                            resolve();
                        };
                        reader.readAsDataURL(file);
                    } else {
                        resolve();
                    }
                });
            });

            // Convert files to base64 for storage
            const processFiles = documentFiles.map(file => {
                return new Promise((resolve) => {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        files.push({
                            name: file.name,
                            data: e.target.result,
                            size: file.size,
                            type: file.type
                        });
                        resolve();
                    };
                    reader.readAsDataURL(file);
                });
            });

            Promise.all([...processImages, ...processFiles]).then(() => {
                const newAlert = {
                    id: alerts.length + 1,
                    title: document.getElementById('title').value,
                    category: document.getElementById('category').value,
                    priority: document.getElementById('priority').value,
                    status: 'open',
                    assignee: document.getElementById('assignee').value,
                    description: document.getElementById('description').value,
                    images: images,
                    files: files,
                    createdAt: new Date(),
                    updatedAt: new Date()
                };

                alerts.unshift(newAlert);
                renderAlerts();
                this.reset();
                document.getElementById('imagePreview').innerHTML = '';
                document.getElementById('filePreview').innerHTML = '';
                
                // Show success message
                alert('‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            });
        });

        // Search and filter functionality
        function setupFilters() {
            const searchInput = document.getElementById('searchInput');
            const filterCategory = document.getElementById('filterCategory');
            const filterPriority = document.getElementById('filterPriority');
            const filterStatus = document.getElementById('filterStatus');

            [searchInput, filterCategory, filterPriority, filterStatus].forEach(element => {
                element.addEventListener('input', renderAlerts);
            });
        }

        // Render alerts list
        function renderAlerts() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const categoryFilter = document.getElementById('filterCategory').value;
            const priorityFilter = document.getElementById('filterPriority').value;
            const statusFilter = document.getElementById('filterStatus').value;

            let filteredAlerts = alerts.filter(alert => {
                const matchesSearch = alert.title.toLowerCase().includes(searchTerm) || 
                                    alert.description.toLowerCase().includes(searchTerm) ||
                                    alert.assignee.toLowerCase().includes(searchTerm);
                const matchesCategory = !categoryFilter || alert.category === categoryFilter;
                const matchesPriority = !priorityFilter || alert.priority === priorityFilter;
                const matchesStatus = !statusFilter || alert.status === statusFilter;

                return matchesSearch && matchesCategory && matchesPriority && matchesStatus;
            });

            const alertsList = document.getElementById('alertsList');
            
            if (filteredAlerts.length === 0) {
                alertsList.innerHTML = '<p class="text-gray-500 text-center py-8">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</p>';
                return;
            }

            alertsList.innerHTML = filteredAlerts.map(alert => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow cursor-pointer" onclick="showAlertDetail(${alert.id})">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-gray-800 flex-1">${alert.title}</h3>
                        <div class="flex gap-2 ml-4">
                            ${alert.images && alert.images.length > 0 ? `<span class="px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded-full">üì∑ ${alert.images.length}</span>` : ''}
                            ${alert.files && alert.files.length > 0 ? `<span class="px-2 py-1 text-xs bg-green-100 text-green-800 rounded-full">üìé ${alert.files.length}</span>` : ''}
                            <span class="px-2 py-1 text-xs rounded-full ${priorityColors[alert.priority]}">${priorityLabels[alert.priority]}</span>
                            <span class="px-2 py-1 text-xs rounded-full ${statusColors[alert.status]}">${statusLabels[alert.status]}</span>
                        </div>
                    </div>
                    <div class="text-sm text-gray-600 mb-2">
                        <span class="font-medium">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</span> ${categoryLabels[alert.category]} | 
                        <span class="font-medium">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö:</span> ${alert.assignee}
                    </div>
                    <p class="text-gray-700 text-sm mb-2">${alert.description.substring(0, 100)}${alert.description.length > 100 ? '...' : ''}</p>
                    <div class="text-xs text-gray-500">
                        ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠: ${alert.createdAt.toLocaleDateString('th-TH')} ${alert.createdAt.toLocaleTimeString('th-TH', {hour: '2-digit', minute: '2-digit'})}
                    </div>
                </div>
            `).join('');
        }

        // Show alert detail modal
        function showAlertDetail(alertId) {
            const alert = alerts.find(a => a.id === alertId);
            if (!alert) return;

            const modalContent = document.getElementById('modalContent');
            modalContent.innerHTML = `
                <div class="space-y-4">
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠</h4>
                        <p class="text-gray-700">${alert.title}</p>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</h4>
                            <p class="text-gray-700">${categoryLabels[alert.category]}</p>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç</h4>
                            <span class="px-2 py-1 text-sm rounded-full ${priorityColors[alert.priority]}">${priorityLabels[alert.priority]}</span>
                        </div>
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</h4>
                            <span class="px-2 py-1 text-sm rounded-full ${statusColors[alert.status]}">${statusLabels[alert.status]}</span>
                        </div>
                        <div>
                            <h4 class="font-semibold text-gray-800 mb-2">‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</h4>
                            <p class="text-gray-700">${alert.assignee}</p>
                        </div>
                    </div>
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</h4>
                        <p class="text-gray-700 whitespace-pre-wrap">${alert.description}</p>
                    </div>
                    ${alert.images && alert.images.length > 0 ? `
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÅ‡∏ô‡∏ö (${alert.images.length} ‡πÑ‡∏ü‡∏•‡πå)</h4>
                        <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
                            ${alert.images.map((image, index) => `
                                <div class="relative group">
                                    <img src="${image.data}" alt="${image.name}" class="w-full h-32 object-cover rounded-lg border cursor-pointer hover:opacity-75 transition-opacity" onclick="viewFullImage('${image.data}', '${image.name}')">
                                    <div class="absolute bottom-0 left-0 right-0 bg-black bg-opacity-50 text-white text-xs p-2 rounded-b-lg opacity-0 group-hover:opacity-100 transition-opacity">
                                        <div class="truncate">${image.name}</div>
                                        <div>${(image.size / 1024).toFixed(1)} KB</div>
                                    </div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                    ${alert.files && alert.files.length > 0 ? `
                    <div>
                        <h4 class="font-semibold text-gray-800 mb-2">‡πÑ‡∏ü‡∏•‡πå‡πÅ‡∏ô‡∏ö (${alert.files.length} ‡πÑ‡∏ü‡∏•‡πå)</h4>
                        <div class="space-y-2">
                            ${alert.files.map((file, index) => `
                                <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg border hover:bg-gray-100 transition-colors">
                                    <div class="flex items-center space-x-3">
                                        <div class="text-2xl">${getFileIcon(file.type, file.name)}</div>
                                        <div>
                                            <div class="text-sm font-medium text-gray-800">${file.name}</div>
                                            <div class="text-xs text-gray-500">${(file.size / 1024).toFixed(1)} KB</div>
                                        </div>
                                    </div>
                                    <button onclick="downloadFile('${file.data}', '${file.name}')" class="text-blue-600 hover:text-blue-800 text-sm font-medium">
                                        ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                    ` : ''}
                    <div class="grid grid-cols-2 gap-4 text-sm text-gray-500">
                        <div>
                            <span class="font-medium">‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÄ‡∏°‡∏∑‡πà‡∏≠:</span><br>
                            ${alert.createdAt.toLocaleDateString('th-TH')} ${alert.createdAt.toLocaleTimeString('th-TH')}
                        </div>
                        <div>
                            <span class="font-medium">‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î:</span><br>
                            ${alert.updatedAt.toLocaleDateString('th-TH')} ${alert.updatedAt.toLocaleTimeString('th-TH')}
                        </div>
                    </div>
                    <div class="flex gap-2 pt-4">
                        <button onclick="updateStatus(${alert.id}, 'in-progress')" class="bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-lg text-sm">
                            ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£
                        </button>
                        <button onclick="updateStatus(${alert.id}, 'resolved')" class="bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg text-sm">
                            ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÅ‡∏•‡πâ‡∏ß
                        </button>
                    </div>
                </div>
            `;

            document.getElementById('alertModal').classList.remove('hidden');
            document.getElementById('alertModal').classList.add('flex');
        }

        // Update alert status
        function updateStatus(alertId, newStatus) {
            const alertIndex = alerts.findIndex(a => a.id === alertId);
            if (alertIndex !== -1) {
                alerts[alertIndex].status = newStatus;
                alerts[alertIndex].updatedAt = new Date();
                renderAlerts();
                document.getElementById('alertModal').classList.add('hidden');
                document.getElementById('alertModal').classList.remove('flex');
                alert('‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß');
            }
        }

        // Close modal
        document.getElementById('closeModal').addEventListener('click', function() {
            document.getElementById('alertModal').classList.add('hidden');
            document.getElementById('alertModal').classList.remove('flex');
        });

        // Close modal when clicking outside
        document.getElementById('alertModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
                this.classList.remove('flex');
            }
        });

        // View full image
        function viewFullImage(imageSrc, imageName) {
            document.getElementById('fullImage').src = imageSrc;
            document.getElementById('fullImage').alt = imageName;
            document.getElementById('imageInfo').textContent = imageName;
            document.getElementById('imageModal').classList.remove('hidden');
            document.getElementById('imageModal').classList.add('flex');
        }

        // Close image modal
        document.getElementById('closeImageModal').addEventListener('click', function() {
            document.getElementById('imageModal').classList.add('hidden');
            document.getElementById('imageModal').classList.remove('flex');
        });

        // Close image modal when clicking outside
        document.getElementById('imageModal').addEventListener('click', function(e) {
            if (e.target === this) {
                this.classList.add('hidden');
                this.classList.remove('flex');
            }
        });

        // Download file function
        function downloadFile(fileData, fileName) {
            const link = document.createElement('a');
            link.href = fileData;
            link.download = fileName;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Initialize the app
        setupFilters();
        renderAlerts();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'98413238001dd032',t:'MTc1ODcwNTUyNC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
